# 攻击系统说明

## 概述
玩家在BOSS精力条耗尽时进入攻击阶段，可在16拍内发动各种攻击。

## 攻击类型

### 1. 轻攻击 (LIGHT)
- **触发按键**: 第一条轨道（HIT）
- **效果**:
  - 消耗玩家血量
  - 对BOSS造成伤害
  - 减少BOSS精力条最大值
- **特点**: 消耗较少，伤害适中

### 2. 重攻击 (HEAVY)
- **触发按键**: 第二条轨道（GUARD）
- **效果**:
  - 消耗玩家血量（较多）
  - 对BOSS造成高伤害
  - 减少BOSS精力条最大值（较多）
- **特点**: 消耗2拍，伤害高，消耗大

### 3. 回复 (HEAL)
- **触发按键**: 第三条轨道（DODGE）
- **效果**:
  - 恢复玩家血量
- **特点**: 无伤害输出，纯回复

### 4. 蓄力 (ENHANCE)
- **触发**: 在节拍窗口（±150ms）内不输入，或输入时机不对
- **效果**:
  - 标记下次轻/重攻击为蓄力版本
  - 连续蓄力无额外效果
- **特点**: 蓄力版本攻击消耗更少，伤害更高

## 蓄力机制

### 蓄力轻攻击
- 消耗血量减少（约40%）
- 伤害提升（约75%）
- 精力上限削减提升（约60%）

### 蓄力重攻击
- 消耗血量减少（约53%）
- 伤害提升（约60%）
- 精力上限削减提升（约50%）

## 视觉反馈
- **蓝色音符**: 轻攻击
- **黄色音符**: 重攻击
- **绿色音符**: 回复
- **红色音符**: 蓄力（带橙色闪烁边框）

## 配置文件
所有数值在 `config/attack_config.tres` 中配置，可调整：
- 各攻击的血量消耗
- 各攻击的BOSS伤害
- 各攻击的精力上限削减值
- 回复量

## BOSS精力条机制
- 每次攻击阶段结束后，BOSS精力条恢复到**当前最大值**而非初始最大值
- 最大值被削减后不会恢复
- 最小保留10点精力上限
- 通过削减精力上限可以让后续攻击阶段更快触发
