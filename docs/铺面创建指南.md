# é“ºé¢åˆ›å»ºæŒ‡å—

## æ–¹æ³•ä¸€ï¼šåœ¨ Godot ç¼–è¾‘å™¨ä¸­åˆ›å»ºé“ºé¢èµ„æºï¼ˆæ¨èï¼‰

### æ­¥éª¤ï¼š

1. **åˆ›å»º Chart èµ„æº**
   - åœ¨ Godot ç¼–è¾‘å™¨çš„æ–‡ä»¶ç³»ç»Ÿé¢æ¿ä¸­ï¼Œå³é”®ç‚¹å‡» `charts/` æ–‡ä»¶å¤¹
   - é€‰æ‹© `æ–°å»ºèµ„æº...`
   - åœ¨å¼¹å‡ºçª—å£ä¸­æœç´¢ `Chart`
   - ç‚¹å‡» `åˆ›å»º`ï¼Œå‘½åä¸ºä½ çš„é“ºé¢åç§°ï¼ˆä¾‹å¦‚ `hydrogen_chart.tres`ï¼‰

2. **é…ç½®åŸºç¡€ä¿¡æ¯**
   - åœ¨æ£€æŸ¥å™¨ä¸­è®¾ç½®é“ºé¢å±æ€§ï¼š
	 - `Chart Name`: é“ºé¢åç§°ï¼ˆä¾‹å¦‚ "Hydrogen - Easy"ï¼‰
	 - `Music Path`: éŸ³ä¹æ–‡ä»¶è·¯å¾„ï¼ˆä¾‹å¦‚ "res://music/M.O.O.N. - Hydrogen.mp3"ï¼‰
	 - `Bpm`: æ­Œæ›²çš„ BPMï¼ˆä¾‹å¦‚ 128ï¼‰
	 - `Offset`: èŠ‚æ‹åç§»é‡ï¼ˆç§’ï¼Œé»˜è®¤ 0ï¼‰

3. **æ·»åŠ éŸ³ç¬¦**
   - å±•å¼€ `Notes` æ•°ç»„
   - ç‚¹å‡» `+` æŒ‰é’®æ·»åŠ æ–°éŸ³ç¬¦
   - å¯¹äºæ¯ä¸ªéŸ³ç¬¦ï¼Œç‚¹å‡» `<ç©º>` é€‰æ‹© `æ–°å»º Note`
   - é…ç½®éŸ³ç¬¦å±æ€§ï¼š
	 - `Beat Number`: èŠ‚æ‹ç¼–å·ï¼ˆæ”¯æŒæµ®ç‚¹æ•°ï¼Œå¦‚ 1.0ã€1.5 è¡¨ç¤ºåŠæ‹ã€1.333 è¡¨ç¤ºä¸‰è¿éŸ³ï¼‰
	 - `Beat Time`: èŠ‚æ‹æ—¶é—´ï¼ˆç§’ï¼Œè‡ªåŠ¨è®¡ç®—æˆ–æ‰‹åŠ¨è®¾ç½®ï¼‰
	 - `Type`: éŸ³ç¬¦ç±»å‹ï¼ˆ0=HIT, 1=GUARD, 2=DODGEï¼‰
   
   > **æç¤º**ï¼šç°åœ¨æ”¯æŒç»†åˆ†èŠ‚æ‹ï¼å¯ä»¥ä½¿ç”¨æµ®ç‚¹æ•°å¦‚ `1.5`ï¼ˆåŠæ‹ï¼‰ã€`1.333`ï¼ˆä¸‰è¿éŸ³ï¼‰ç­‰ã€‚è¯¦è§[ç»†åˆ†èŠ‚æ‹ä½¿ç”¨æŒ‡å—](ç»†åˆ†èŠ‚æ‹ä½¿ç”¨æŒ‡å—.md)ã€‚

4. **ä¿å­˜é“ºé¢**
   - æŒ‰ `Ctrl+S` ä¿å­˜èµ„æºæ–‡ä»¶

---

## æ–¹æ³•äºŒï¼šæ‰‹åŠ¨ç¼–è¾‘ .tres æ–‡ä»¶

å¯ä»¥ç›´æ¥åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­åˆ›å»º/ç¼–è¾‘ `.tres` èµ„æºæ–‡ä»¶ã€‚å‚è€ƒ `charts/example_chart.tres` ç¤ºä¾‹ã€‚

### éŸ³ç¬¦ç±»å‹ä»£ç ï¼š
- `0` = HITï¼ˆæ”»å‡»ï¼‰ âš”ï¸
- `1` = GUARDï¼ˆé˜²å¾¡ï¼‰ ğŸ›¡ï¸
- `2` = DODGEï¼ˆé—ªé¿ï¼‰ ğŸ’¨

---

## æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ JSON æ ¼å¼

å·²æ”¯æŒä» JSON æ–‡ä»¶å¯¼å…¥é“ºé¢ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```json
{
  "chart_name": "Hydrogen - Easy",
  "music_path": "res://music/M.O.O.N. - Hydrogen.mp3",
  "bpm": 128,
  "offset": 0.0,
  "notes": [
	{"beat": 0.0, "type": "HIT"},
	{"beat": 0.5, "type": "GUARD"},  // æ”¯æŒåŠæ‹
	{"beat": 1.0, "type": "DODGE"},
	{"beat": 1.333, "type": "HIT"},  // æ”¯æŒä¸‰è¿éŸ³
	{"beat": 1.667, "type": "GUARD"},
	{"beat": 2.0, "type": "DODGE"}
  ]
}
```

> **æ³¨æ„**ï¼šèŠ‚æ‹ç¼–å· `beat` æ”¯æŒæµ®ç‚¹æ•°ï¼Œå¯è¡¨ç¤ºåŠæ‹ï¼ˆ0.5ï¼‰ã€ä¸‰è¿éŸ³ï¼ˆ0.333, 0.667ï¼‰ç­‰ã€‚è¯¦è§[ç»†åˆ†èŠ‚æ‹ä½¿ç”¨æŒ‡å—](ç»†åˆ†èŠ‚æ‹ä½¿ç”¨æŒ‡å—.md)ã€‚

---

## åœ¨ä»£ç ä¸­åŠ è½½é“ºé¢

### æ–¹æ³• 1ï¼šä¿®æ”¹ BeatManager åŠ è½½è‡ªå®šä¹‰é“ºé¢

åœ¨ `BeatManager.gd` ä¸­ï¼š

```gdscript
# ç¦ç”¨è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•é“ºé¢
@export var generate_test_chart: bool = false
@export var chart_resource: Chart = null  # æ‹–å…¥ä½ çš„é“ºé¢èµ„æº

func _on_music_started() -> void:
	is_playing = true
	current_beat = 0
	next_beat_time = offset
	
	# åŠ è½½è‡ªå®šä¹‰é“ºé¢
	if chart_resource:
		current_chart = chart_resource
		print("å·²åŠ è½½é“ºé¢: ", current_chart.chart_name)
	elif generate_test_chart:
		_generate_test_chart()
```

### æ–¹æ³• 2ï¼šä»£ç ä¸­ç›´æ¥åŠ è½½

```gdscript
var chart = load("res://charts/example_chart.tres") as Chart
current_chart = chart
```

---

## é“ºé¢è®¾è®¡æŠ€å·§

1. **BPM ç¡®å®š**ï¼šä½¿ç”¨éŸ³ä¹åˆ†æå·¥å…·æˆ–åœ¨çº¿ BPM æ£€æµ‹å™¨æ‰¾åˆ°æ­Œæ›²çš„å‡†ç¡® BPM
2. **Offset è°ƒæ•´**ï¼šå¦‚æœèŠ‚æ‹ä¸å‡†ï¼Œå¾®è°ƒ offset å€¼ï¼ˆé€šå¸¸åœ¨ -0.1 åˆ° 0.1 ç§’ä¹‹é—´ï¼‰
3. **éŸ³ç¬¦åˆ†å¸ƒ**ï¼š
   - å‰å‡ æ‹ç•™ç©ºï¼Œç»™ç©å®¶å‡†å¤‡æ—¶é—´
   - ä¸è¦æ¯æ‹éƒ½æ”¾éŸ³ç¬¦ï¼Œç•™å‡ºå–˜æ¯ç©ºé—´
   - åœ¨éŸ³ä¹é«˜æ½®å¤„å¢åŠ éŸ³ç¬¦å¯†åº¦
4. **ç±»å‹å¹³è¡¡**ï¼šåˆç†åˆ†é… HITã€GUARDã€DODGE ä¸‰ç§ç±»å‹ï¼Œé¿å…å•ä¸€é‡å¤

---

## æµ‹è¯•é“ºé¢

1. åœ¨ Godot åœºæ™¯ä¸­é€‰æ‹© `BeatManager` èŠ‚ç‚¹
2. åœ¨æ£€æŸ¥å™¨ä¸­ï¼š
   - å–æ¶ˆå‹¾é€‰ `Generate Test Chart`
   - å°†ä½ çš„é“ºé¢èµ„æºæ‹–åˆ° `Chart Resource` å±æ€§
3. è¿è¡Œæ¸¸æˆï¼ˆF5ï¼‰æŸ¥çœ‹æ—¥å¿—è¾“å‡º
4. æ ¹æ®éŸ³ä¹èŠ‚å¥è°ƒæ•´ BPM å’Œ offset
